define([],function(){"use strict";function t(t,e){this.name=null!=t?t:"base_controller",this.methods=null!=e?e:{},this.view_data={},this.setup()}return t.prototype.setup=function(){var t,e,r,n;this.method_names=[],r=this.methods,n=[];for(t in r)e=r[t],n.push(this.method_names.push(t));return n},t.prototype.template_name=function(t){return""+this.name+"_"+t+"_template"},t.prototype.data=function(t,e){var r,n;if(null==e&&(e=null),"object"==typeof t)for(r in t)n=t[r],this.view_data[r]=n;else this.view_data[t]=e;return this.view_data},t.prototype.update_page_meta=function(){return null!=this.view_data.title?$("title").text(this.view_data.title):void 0},t.prototype.render=function(t){var e,r;return null==t&&(t=".body"),this.current_method?(e=$(t),r=$("#"+this.template_name(this.current_method_name)),this.update_page_meta(),e.length?r.length?(e.empty(),e.html(Mustache.render(r.html(),this.view_data))):console.error("template not found"):console.error("target not found")):console.error("controller render called without method setup! should be invoked by router")},t.prototype._handle=function(t,e){return null==e&&(e={}),this.methods.hasOwnProperty(t)?(this.current_method=this.methods[t],this.current_method_name=t,"function"==typeof this.current_method?this.current_method.call(this,e):"string"==typeof this.current_method?require([this.current_method],function(t){return function(r){return t.current_method=r,t.current_method.call(t,e)}}(this)):(console.error("route '"+t+"' doesnt seem set up properly"),!1)):console.error("unhandled route for "+this.name+" controller: "+t)},t});