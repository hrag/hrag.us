!function(e,t,n){"function"==typeof define&&define.amd?define(["jquery"],function(o){return n(o,e,t),o.mobile}):n(e.jQuery,e,t)}(this,document,function(e,t,n,o){!function(e,t,n,o){function s(e){for(;e&&"undefined"!=typeof e.originalEvent;)e=e.originalEvent;return e}function r(t,n){var r,i,a,c,u,h,l,p,d,f=t.type;if(t=e.Event(t),t.type=n,r=t.originalEvent,i=e.event.props,f.search(/^(mouse|click)/)>-1&&(i=B),r)for(l=i.length,c;l;)c=i[--l],t[c]=r[c];if(f.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),-1!==f.search(/^touch/)&&(a=s(r),f=a.touches,u=a.changedTouches,h=f&&f.length?f[0]:u&&u.length?u[0]:o))for(p=0,d=H.length;d>p;p++)c=H[p],t[c]=h[c];return t}function i(t){for(var n,o,s={};t;){n=e.data(t,T);for(o in n)n[o]&&(s[o]=s.hasVirtualBinding=!0);t=t.parentNode}return s}function a(t,n){for(var o;t;){if(o=e.data(t,T),o&&(!n||o[n]))return t;t=t.parentNode}return null}function c(){C=!1}function u(){C=!0}function h(){F=0,Y.length=0,M=!1,u()}function l(){c()}function p(){d(),E=setTimeout(function(){E=0,h()},e.vmouse.resetTimerDuration)}function d(){E&&(clearTimeout(E),E=0)}function f(t,n,o){var s;return(o&&o[t]||!o&&a(n.target,t))&&(s=r(n,t),e(n.target).trigger(s)),s}function v(t){var n,o=e.data(t.target,y);M||F&&F===o||(n=f("v"+t.type,t),n&&(n.isDefaultPrevented()&&t.preventDefault(),n.isPropagationStopped()&&t.stopPropagation(),n.isImmediatePropagationStopped()&&t.stopImmediatePropagation()))}function m(t){var n,o,r,a=s(t).touches;a&&1===a.length&&(n=t.target,o=i(n),o.hasVirtualBinding&&(F=$++,e.data(n,y,F),d(),l(),X=!1,r=s(t).touches[0],L=r.pageX,A=r.pageY,f("vmouseover",t,o),f("vmousedown",t,o)))}function g(e){C||(X||f("vmousecancel",e,i(e.target)),X=!0,p())}function b(t){if(!C){var n=s(t).touches[0],o=X,r=e.vmouse.moveDistanceThreshold,a=i(t.target);X=X||Math.abs(n.pageX-L)>r||Math.abs(n.pageY-A)>r,X&&!o&&f("vmousecancel",t,a),f("vmousemove",t,a),p()}}function w(e){if(!C){u();var t,n,o=i(e.target);f("vmouseup",e,o),X||(t=f("vclick",e,o),t&&t.isDefaultPrevented()&&(n=s(e).changedTouches[0],Y.push({touchID:F,x:n.clientX,y:n.clientY}),M=!0)),f("vmouseout",e,o),X=!1,p()}}function U(t){var n,o=e.data(t,T);if(o)for(n in o)if(o[n])return!0;return!1}function D(){}function P(t){var n=t.substr(1);return{setup:function(){U(this)||e.data(this,T,{});var o=e.data(this,T);o[t]=!0,N[t]=(N[t]||0)+1,1===N[t]&&R.bind(n,v),e(this).bind(n,D),O&&(N.touchstart=(N.touchstart||0)+1,1===N.touchstart&&R.bind("touchstart",m).bind("touchend",w).bind("touchmove",b).bind("scroll",g))},teardown:function(){--N[t],N[t]||R.unbind(n,v),O&&(--N.touchstart,N.touchstart||R.unbind("touchstart",m).unbind("touchmove",b).unbind("touchend",w).unbind("scroll",g));var o=e(this),s=e.data(this,T);s&&(s[t]=!1),o.unbind(n,D),U(this)||o.removeData(T)}}}var k,x,T="virtualMouseBindings",y="virtualTouchID",I="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),H="clientX clientY pageX pageY screenX screenY".split(" "),S=e.event.mouseHooks?e.event.mouseHooks.props:[],B=e.event.props.concat(S),N={},E=0,L=0,A=0,X=!1,Y=[],M=!1,C=!1,O="addEventListener"in n,R=e(n),$=1,F=0;for(e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},x=0;x<I.length;x++)e.event.special[I[x]]=P(I[x]);O&&n.addEventListener("click",function(t){var n,o,s,r,i,a,c=Y.length,u=t.target;if(c)for(n=t.clientX,o=t.clientY,k=e.vmouse.clickDistanceThreshold,s=u;s;){for(r=0;c>r;r++)if(i=Y[r],a=0,s===u&&Math.abs(i.x-n)<k&&Math.abs(i.y-o)<k||e.data(s,y)===i.touchID)return t.preventDefault(),void t.stopPropagation();s=s.parentNode}},!0)}(e,t,n),function(e){e.mobile={}}(e),function(e,t){var o={touch:"ontouchend"in n};e.mobile.support=e.mobile.support||{},e.extend(e.support,o),e.extend(e.mobile.support,o)}(e),function(e,t,o){function s(t,n,s,r){var i=s.type;s.type=n,r?e.event.trigger(s,o,t):e.event.dispatch.call(t,s),s.type=i}var r=e(n),i=e.mobile.support.touch,a="touchmove scroll",c=i?"touchstart":"mousedown",u=i?"touchend":"mouseup",h=i?"touchmove":"mousemove";e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(t,n){e.fn[n]=function(e){return e?this.bind(n,e):this.trigger(n)},e.attrFn&&(e.attrFn[n]=!0)}),e.event.special.scrollstart={enabled:!0,setup:function(){function t(e,t){n=t,s(r,n?"scrollstart":"scrollstop",e)}var n,o,r=this,i=e(r);i.bind(a,function(s){e.event.special.scrollstart.enabled&&(n||t(s,!0),clearTimeout(o),o=setTimeout(function(){t(s,!1)},50))})},teardown:function(){e(this).unbind(a)}},e.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var t=this,n=e(t),o=!1;n.bind("vmousedown",function(i){function a(){clearTimeout(h)}function c(){a(),n.unbind("vclick",u).unbind("vmouseup",a),r.unbind("vmousecancel",c)}function u(e){c(),o||l!==e.target?o&&e.preventDefault():s(t,"tap",e)}if(o=!1,i.which&&1!==i.which)return!1;var h,l=i.target;n.bind("vmouseup",a).bind("vclick",u),r.bind("vmousecancel",c),h=setTimeout(function(){e.event.special.tap.emitTapOnTaphold||(o=!0),s(t,"taphold",e.Event("taphold",{target:l}))},e.event.special.tap.tapholdThreshold)})},teardown:function(){e(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),r.unbind("vmousecancel")}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:30,getLocation:function(e){var n=t.pageXOffset,o=t.pageYOffset,s=e.clientX,r=e.clientY;return 0===e.pageY&&Math.floor(r)>Math.floor(e.pageY)||0===e.pageX&&Math.floor(s)>Math.floor(e.pageX)?(s-=n,r-=o):(r<e.pageY-o||s<e.pageX-n)&&(s=e.pageX-n,r=e.pageY-o),{x:s,y:r}},start:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,o=e.event.special.swipe.getLocation(n);return{time:(new Date).getTime(),coords:[o.x,o.y],origin:e(t.target)}},stop:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,o=e.event.special.swipe.getLocation(n);return{time:(new Date).getTime(),coords:[o.x,o.y]}},handleSwipe:function(t,n,o,r){if(n.time-t.time<e.event.special.swipe.durationThreshold&&Math.abs(t.coords[0]-n.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(t.coords[1]-n.coords[1])<e.event.special.swipe.verticalDistanceThreshold){var i=t.coords[0]>n.coords[0]?"swipeleft":"swiperight";return s(o,"swipe",e.Event("swipe",{target:r,swipestart:t,swipestop:n}),!0),s(o,i,e.Event(i,{target:r,swipestart:t,swipestop:n}),!0),!0}return!1},eventInProgress:!1,setup:function(){var t,n=this,o=e(n),s={};t=e.data(this,"mobile-events"),t||(t={length:0},e.data(this,"mobile-events",t)),t.length++,t.swipe=s,s.start=function(t){if(!e.event.special.swipe.eventInProgress){e.event.special.swipe.eventInProgress=!0;var o,i=e.event.special.swipe.start(t),a=t.target,c=!1;s.move=function(t){i&&!t.isDefaultPrevented()&&(o=e.event.special.swipe.stop(t),c||(c=e.event.special.swipe.handleSwipe(i,o,n,a),c&&(e.event.special.swipe.eventInProgress=!1)),Math.abs(i.coords[0]-o.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&t.preventDefault())},s.stop=function(){c=!0,e.event.special.swipe.eventInProgress=!1,r.off(h,s.move),s.move=null},r.on(h,s.move).one(u,s.stop)}},o.on(c,s.start)},teardown:function(){var t,n;t=e.data(this,"mobile-events"),t&&(n=t.swipe,delete t.swipe,t.length--,0===t.length&&e.removeData(this,"mobile-events")),n&&(n.start&&e(this).off(c,n.start),n.move&&r.off(h,n.move),n.stop&&r.off(u,n.stop))}},e.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(t,n){e.event.special[t]={setup:function(){e(this).bind(n,e.noop)},teardown:function(){e(this).unbind(n)}}})}(e,this),function(e,n){var o,s,r="&ui-state=dialog";e.mobile.path=o={uiStateKey:"&ui-state",urlParseRE:/^\s*(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,getLocation:function(e){var t=this.parseUrl(e||location.href),n=e?t:location,o=t.hash;return o="#"===o?"":o,n.protocol+t.doubleSlash+n.host+(""!==n.protocol&&"/"!==n.pathname.substring(0,1)?"/":"")+n.pathname+n.search+o},getDocumentUrl:function(t){return t?e.extend({},o.documentUrl):o.documentUrl.href},parseLocation:function(){return this.parseUrl(this.getLocation())},parseUrl:function(t){if("object"===e.type(t))return t;var n=o.urlParseRE.exec(t||"")||[];return{href:n[0]||"",hrefNoHash:n[1]||"",hrefNoSearch:n[2]||"",domain:n[3]||"",protocol:n[4]||"",doubleSlash:n[5]||"",authority:n[6]||"",username:n[8]||"",password:n[9]||"",host:n[10]||"",hostname:n[11]||"",port:n[12]||"",pathname:n[13]||"",directory:n[14]||"",filename:n[15]||"",search:n[16]||"",hash:n[17]||""}},makePathAbsolute:function(e,t){var n,o,s,r;if(e&&"/"===e.charAt(0))return e;for(e=e||"",t=t?t.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"",n=t?t.split("/"):[],o=e.split("/"),s=0;s<o.length;s++)switch(r=o[s]){case".":break;case"..":n.length&&n.pop();break;default:n.push(r)}return"/"+n.join("/")},isSameDomain:function(e,t){return o.parseUrl(e).domain.toLowerCase()===o.parseUrl(t).domain.toLowerCase()},isRelativeUrl:function(e){return""===o.parseUrl(e).protocol},isAbsoluteUrl:function(e){return""!==o.parseUrl(e).protocol},makeUrlAbsolute:function(e,t){if(!o.isRelativeUrl(e))return e;t===n&&(t=this.documentBase);var s=o.parseUrl(e),r=o.parseUrl(t),i=s.protocol||r.protocol,a=s.protocol?s.doubleSlash:s.doubleSlash||r.doubleSlash,c=s.authority||r.authority,u=""!==s.pathname,h=o.makePathAbsolute(s.pathname||r.filename,r.pathname),l=s.search||!u&&r.search||"",p=s.hash;return i+a+c+h+l+p},addSearchParams:function(t,n){var s=o.parseUrl(t),r="object"==typeof n?e.param(n):n,i=s.search||"?";return s.hrefNoSearch+i+("?"!==i.charAt(i.length-1)?"&":"")+r+(s.hash||"")},convertUrlToDataUrl:function(e){var n=e,s=o.parseUrl(e);return o.isEmbeddedPage(s)?n=s.hash.split(r)[0].replace(/^#/,"").replace(/\?.*$/,""):o.isSameDomain(s,this.documentBase)&&(n=s.hrefNoHash.replace(this.documentBase.domain,"").split(r)[0]),t.decodeURIComponent(n)},get:function(e){return e===n&&(e=o.parseLocation().hash),o.stripHash(e).replace(/[^\/]*\.[^\/*]+$/,"")},set:function(e){location.hash=e},isPath:function(e){return/\//.test(e)},clean:function(e){return e.replace(this.documentBase.domain,"")},stripHash:function(e){return e.replace(/^#/,"")},stripQueryParams:function(e){return e.replace(/\?.*$/,"")},cleanHash:function(e){return o.stripHash(e.replace(/\?.*$/,"").replace(r,""))},isHashValid:function(e){return/^#[^#]+$/.test(e)},isExternal:function(e){var t=o.parseUrl(e);return!(!t.protocol||t.domain.toLowerCase()===this.documentUrl.domain.toLowerCase())},hasProtocol:function(e){return/^(:?\w+:)/.test(e)},isEmbeddedPage:function(e){var t=o.parseUrl(e);return""!==t.protocol?!this.isPath(t.hash)&&t.hash&&(t.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&t.hrefNoHash===this.documentBase.hrefNoHash):/^#/.test(t.href)},squash:function(e,t){var n,s,r,i,a,c=this.isPath(e),u=this.parseUrl(e),h=u.hash,l="";return t||(c?t=o.getLocation():(a=o.getDocumentUrl(!0),t=o.isPath(a.hash)?o.squash(a.href):a.href)),s=c?o.stripHash(e):e,s=o.isPath(u.hash)?o.stripHash(u.hash):s,i=s.indexOf(this.uiStateKey),i>-1&&(l=s.slice(i),s=s.slice(0,i)),n=o.makeUrlAbsolute(s,t),r=this.parseUrl(n).search,c?((o.isPath(h)||0===h.replace("#","").indexOf(this.uiStateKey))&&(h=""),l&&-1===h.indexOf(this.uiStateKey)&&(h+=l),-1===h.indexOf("#")&&""!==h&&(h="#"+h),n=o.parseUrl(n),n=n.protocol+n.doubleSlash+n.host+n.pathname+r+h):n+=n.indexOf("#")>-1?l:"#"+l,n},isPreservableHash:function(e){return 0===e.replace("#","").indexOf(this.uiStateKey)},hashToSelector:function(e){var t="#"===e.substring(0,1);return t&&(e=e.substring(1)),(t?"#":"")+e.replace(/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,"\\$1")},getFilePath:function(e){return e&&e.split(r)[0]},isFirstPageUrl:function(t){var s=o.parseUrl(o.makeUrlAbsolute(t,this.documentBase)),r=s.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&s.hrefNoHash===this.documentBase.hrefNoHash,i=e.mobile.firstPage,a=i&&i[0]?i[0].id:n;return r&&(!s.hash||"#"===s.hash||a&&s.hash.replace(/^#/,"")===a)},isPermittedCrossDomainRequest:function(t,n){return e.mobile.allowCrossDomainPages&&("file:"===t.protocol||"content:"===t.protocol)&&-1!==n.search(/^https?:/)}},o.documentUrl=o.parseLocation(),s=e("head").find("base"),o.documentBase=s.length?o.parseUrl(o.makeUrlAbsolute(s.attr("href"),o.documentUrl.href)):o.documentUrl,o.documentBaseDiffers=o.documentUrl.hrefNoHash!==o.documentBase.hrefNoHash,o.getDocumentBase=function(t){return t?e.extend({},o.documentBase):o.documentBase.href},e.extend(e.mobile,{getDocumentUrl:o.getDocumentUrl,getDocumentBase:o.getDocumentBase})}(e),function(e,t){e.mobile.History=function(e,t){this.stack=e||[],this.activeIndex=t||0},e.extend(e.mobile.History.prototype,{getActive:function(){return this.stack[this.activeIndex]},getLast:function(){return this.stack[this.previousIndex]},getNext:function(){return this.stack[this.activeIndex+1]},getPrev:function(){return this.stack[this.activeIndex-1]},add:function(e,t){t=t||{},this.getNext()&&this.clearForward(),t.hash&&-1===t.hash.indexOf("#")&&(t.hash="#"+t.hash),t.url=e,this.stack.push(t),this.activeIndex=this.stack.length-1},clearForward:function(){this.stack=this.stack.slice(0,this.activeIndex+1)},find:function(e,t,n){t=t||this.stack;var o,s,r,i=t.length;for(s=0;i>s;s++)if(o=t[s],(decodeURIComponent(e)===decodeURIComponent(o.url)||decodeURIComponent(e)===decodeURIComponent(o.hash))&&(r=s,n))return r;return r},closest:function(e){var n,o=this.activeIndex;return n=this.find(e,this.stack.slice(0,o)),n===t&&(n=this.find(e,this.stack.slice(o),!0),n=n===t?n:n+o),n},direct:function(n){var o=this.closest(n.url),s=this.activeIndex;o!==t&&(this.activeIndex=o,this.previousIndex=s),s>o?(n.present||n.back||e.noop)(this.getActive(),"back"):o>s?(n.present||n.forward||e.noop)(this.getActive(),"forward"):o===t&&n.missing&&n.missing(this.getActive())}})}(e)});