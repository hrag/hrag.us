define([],function(){function e(e,t){this.name=e!=null?e:"base_controller",this.methods=t!=null?t:{},this.view_data={},this.setup()}return e.prototype.setup=function(){var e,t,n,r;this.method_names=[],n=this.methods,r=[];for(e in n)t=n[e],r.push(this.method_names.push(e));return r},e.prototype.template_name=function(e){return""+this.name+"_"+e+"_template"},e.prototype.data=function(e,t){var n,r;t==null&&(t=null);if(typeof e=="object")for(n in e)r=e[n],this.view_data[n]=r;else this.view_data[e]=t;return this.view_data},e.prototype.update_page_meta=function(){if(this.view_data.title!=null)return $("title").text(this.view_data.title)},e.prototype.render=function(e){var t,n;return e==null&&(e=".body"),this.current_method?(t=$(e),n=$("#"+this.template_name(this.current_method_name)),this.update_page_meta(),t.length?n.length?(t.empty(),t.html(Mustache.render(n.html(),this.view_data))):console.error("template not found"):console.error("target not found")):console.error("controller render called without method setup! should be invoked by router")},e.prototype._handle=function(e,t){return t==null&&(t={}),this.methods.hasOwnProperty(e)?(console.log(""+this.name+" controller rendering route: "+e),this.current_method=this.methods[e],this.current_method_name=e,typeof this.current_method=="function"?this.current_method.call(this,t):typeof this.current_method=="string"?require([this.current_method],function(e){return function(n){return e.current_method=n,e.current_method.call(e,t)}}(this)):(console.error("route '"+e+"' doesnt seem set up properly"),!1)):console.error("unhandled route for "+this.name+" controller: "+e)},e});