define(["jquery","json!projects.json","mustache","helpers/before","jquerymob","preload"],function(e,t,n,r){return function(){var i=e(".project__wrapper"),s=e(".project"),o,u=0,a=[],f=e(".footer"),l=e(".project .footer"),c=window.location.hash;c=c.split("/",2),c=c[1].replace("#","");var h=new r("project");i.html("");var p=function(e,t){return t>=e&&(t=0),t};e.get("/templates/project.html",function(r){var f,l=t.length;e.each(t,function(e){if(t[e].id==c){o=e;var n=p(t.length,e+1);f=t[n].id;var r=t[n].name;t[o].nextId=f,t[o].nextName=r,e==l}});var h=n.render(r,t[o]);e.each(t[o].projectScreenshots,function(){a.push(this.src)}),e(a).preload(function(){s.removeClass("project--right").addClass("project--in-view")}),i.append(h),u+=e(window).height()/2,e(".project__screenshot img").load(function(){u+=e(this).height()+39,u=u,e(".project__screenshots").css({height:u*.1+"rem"})}),e(".project__footer__next-button").tap(function(){window.location.hash="project/"+f})}).done(function(){console.log(c+" loaded")}),l.length<1&&e.get("/templates/footer.html",function(e){var t=n.render(e,{});s.append(t)})}});